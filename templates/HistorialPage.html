<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Historial de Eliminados</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body {
            background-color: #f4f4f4;
        }
        .navbar-brand img {
            height: 40px;
        }
        .container {
            margin-top: 30px;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-danger">
    <div class="container-fluid">
        <a class="navbar-brand" href="/">
            <img src="/static/transmilenio.jpg" alt="Logo TransMilenio" />
        </a>
        <div id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="/">ğŸ  Inicio</a></li>
                <li class="nav-item"><a class="nav-link" href="/create">ğŸ†• Crear</a></li>
                <li class="nav-item"><a class="nav-link" href="/read">ğŸ“– Leer</a></li>
                <li class="nav-item"><a class="nav-link" href="/update">âœï¸ Actualizar</a></li>
                <li class="nav-item"><a class="nav-link" href="/delete">âŒ Eliminar</a></li>
                <li class="nav-item"><a class="nav-link active" href="/historial">ğŸ•’ Historial</a></li>
                <li class="nav-item"><a class="nav-link" href="/developer-info">ğŸ‘¨â€ğŸ’» Info Desarrollador</a></li>
                <li class="nav-item"><a class="nav-link" href="/planning">ğŸ—“ï¸ PlaneaciÃ³n</a></li>
                <li class="nav-item"><a class="nav-link" href="/design">ğŸ¨ DiseÃ±o</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container">
    <h2 class="text-center mb-4">Historial de Eliminados</h2>
    <div id="historialContent" class="table-responsive">
        <table class="table table-striped table-bordered">
            <thead class="table-danger">
                <tr>
                    <th>Tipo</th>
                    <th>Detalles</th>
                    <th>Fecha y Hora</th>
                </tr>
            </thead>
            <tbody id="historialTableBody">
                <!-- Data will be populated here -->
            </tbody>
        </table>
    </div>
</div>

<script>
    async function fetchHistorial() {
        try {
            const response = await fetch('/historial');
            if (!response.ok) {
                throw new Error('Error al obtener el historial');
            }
            const data = await response.json();
            const tbody = document.getElementById('historialTableBody');
            tbody.innerHTML = '';
            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" class="text-center">No hay registros en el historial.</td></tr>';
                return;
            }
            data.forEach(item => {
                const tr = document.createElement('tr');
                const tipoTd = document.createElement('td');
                tipoTd.textContent = item.tipo || 'N/A';
                const detallesTd = document.createElement('td');
                detallesTd.textContent = JSON.stringify(item.detalles) || 'N/A';
                const fechaTd = document.createElement('td');
                fechaTd.textContent = item.fecha_hora || 'N/A';
                tr.appendChild(tipoTd);
                tr.appendChild(detallesTd);
                tr.appendChild(fechaTd);
                tbody.appendChild(tr);
            });
        } catch (error) {
            const container = document.getElementById('historialContent');
            container.innerHTML = `<div class="alert alert-danger" role="alert">${error.message}</div>`;
        }
    }

    document.addEventListener('DOMContentLoaded', fetchHistorial);
</script>
</body>
</html>
